// SPDX-License-Identifier: GPL-2.0-only
/*
 * Copyright (C) 2006-2012 Tony Wu (tonywu@realtek.com)
 * Copyright (C) 2020 B. Koblitz
 */
#ifndef _MACH_RTL838X_H_
#define _MACH_RTL838X_H_

struct rtl83xx_soc_info {
	unsigned char *name;
	unsigned int id;
	unsigned int family;
};

/* High 16 bits of MODEL_NAME_INFO register */
#define RTL8389_FAMILY_ID	0x8389
#define RTL8328_FAMILY_ID	0x8328
#define RTL8390_FAMILY_ID	0x8390
#define RTL8350_FAMILY_ID	0x8350
#define RTL8380_FAMILY_ID	0x8380
#define RTL8330_FAMILY_ID	0x8330

/* Register access macros */
#define rtl83xx_r8(reg)		__raw_readb(reg)
#define rtl83xx_w8(val, reg)	__raw_writeb(val, reg)
#define rtl83xx_r32(reg)	__raw_readl(reg)
#define rtl83xx_w32(val, reg)	__raw_writel(val, reg)

// TODO: move to DT
#define RTL83XX_SWITCH_BASE			((volatile void *) 0xBB000000)
#define RTL838X_MODEL_NAME_INFO		(RTL83XX_SWITCH_BASE + 0x00D4)
#define RTL839X_MODEL_NAME_INFO		(RTL83XX_SWITCH_BASE + 0x0FF0)


/*
 * SPRAM
 */
#define RTL838X_ISPRAM_BASE	0x0
#define RTL838X_DSPRAM_BASE	0x0


/*
 * MIPS32R2 counter
 */
#define RTL838X_COMPARE_IRQ	(RTL838X_IRQ_CPU_BASE + 7)


/*
 *  Timer/counter for 8390/80/28 TC & MP chip
 */
#define RTL838X_TIMER0_BASE	((volatile void *)(0xb8003100UL))
#define RTL838X_TIMER0_IRQ	RTL838X_TC0_EXT_IRQ

#define RTL8390TC_TC1DATA	(RTL838X_TIMER0_BASE + 0x04)
#define RTL8390TC_TCD_OFFSET	8
#define RTL8390TC_TC0CNT	(RTL838X_TIMER0_BASE + 0x08)
#define RTL8390TC_TC1CNT	(RTL838X_TIMER0_BASE + 0x0C)
#define RTL8390TC_TCCNR		(RTL838X_TIMER0_BASE + 0x10)
#define RTL8390TC_TC0EN		(1 << 31)
#define RTL8390TC_TC0MODE_TIMER	(1 << 30)
#define RTL8390TC_TC1EN		(1 << 29)
#define RTL8390TC_TC1MODE_TIMER	(1 << 28)
#define RTL8390TC_TCIR		(RTL838X_TIMER0_BASE + 0x14)
#define RTL8390TC_TC0IE		(1 << 31)
#define RTL8390TC_TC1IE		(1 << 30)
#define RTL8390TC_TC0IP		(1 << 29)
#define RTL8390TC_TC1IP		(1 << 28)
#define RTL8390TC_CDBR		(RTL838X_TIMER0_BASE + 0x18)
#define RTL8390TC_DIVF_OFFSET	16
#define RTL8390TC_WDTCNR	(RTL838X_TIMER0_BASE + 0x1C)

#define RTL8390MP_TC1DATA	(RTL838X_TIMER0_BASE + 0x10)
#define RTL8390MP_TC0CNT	(RTL838X_TIMER0_BASE + 0x04)
#define RTL8390MP_TC1CNT	(RTL838X_TIMER0_BASE + 0x14)
#define RTL8390MP_TC0CTL	(RTL838X_TIMER0_BASE + 0x08)
#define RTL8390MP_TC1CTL	(RTL838X_TIMER0_BASE + 0x18)
#define RTL8390MP_TCEN		(1 << 28)
#define RTL8390MP_TCMODE_TIMER	(1 << 24)
#define RTL8390MP_TCDIV_FACTOR	(0xFFFF << 0)
#define RTL8390MP_TC0INT	(RTL838X_TIMER0_BASE + 0xC)
#define RTL8390MP_TC1INT	(RTL838X_TIMER0_BASE + 0x1C)
#define RTL8390MP_TCIE		(1 << 20)
#define RTL8390MP_TCIP		(1 << 16)
#define RTL8390MP_WDTCNR	(RTL838X_TIMER0_BASE + 0x50)

#define RTL8380MP_TC0DATA	(RTL838X_TIMER0_BASE + 0x00)
#define RTL8380MP_TC1DATA	(RTL838X_TIMER0_BASE + 0x10)
#define RTL8380MP_TC0CNT	(RTL838X_TIMER0_BASE + 0x04)
#define RTL8380MP_TC1CNT	(RTL838X_TIMER0_BASE + 0x14)
#define RTL8380MP_TC0CTL	(RTL838X_TIMER0_BASE + 0x08)
#define RTL8380MP_TC1CTL	(RTL838X_TIMER0_BASE + 0x18)
#define RTL8380MP_TCEN		(1 << 28)
#define RTL8380MP_TCMODE_TIMER	(1 << 24)
#define RTL8380MP_TCDIV_FACTOR	(0xFFFF << 0)
#define RTL8380MP_TC0INT	(RTL838X_TIMER0_BASE + 0xC)
#define RTL8380MP_TC1INT	(RTL838X_TIMER0_BASE + 0x1C)
#define RTL8380MP_TCIE		(1 << 20)
#define RTL8380MP_TCIP		(1 << 16)
#define RTL8380MP_WDTCNR	(RTL838X_TIMER0_BASE + 0x50)

#define DIVISOR_RTL8390		55
#define DIVISOR_RTL8380		2500
#define DIVISOR_MAX		16834

/*
 * Memory Controller
 */
#define MC_MCR			0xB8001000
#define MC_MCR_VAL		0x00000000

#define MC_DCR			0xB8001004
#define MC_DCR0_VAL		0x54480000

#define MC_DTCR			0xB8001008
#define MC_DTCR_VAL		0xFFFF05C0

/*
 * GPIO
 */
#define RTL838X_LED_GLB_CTRL		((volatile void *) 0xBB00A000)
#define RTL839X_LED_GLB_CTRL		((volatile void *) 0xBB0000E4)
#define GPIO_CTRL_REG_BASE		((volatile void *) 0xb8003500)
#define RTL838X_GPIO_PABC_CNR		(GPIO_CTRL_REG_BASE + 0x0)
#define RTL838X_GPIO_PABC_TYPE		(GPIO_CTRL_REG_BASE + 0x04)
#define RTL838X_GPIO_PABC_DIR		(GPIO_CTRL_REG_BASE + 0x8)
#define RTL838X_GPIO_PABC_DATA		(GPIO_CTRL_REG_BASE + 0xc)
#define RTL838X_GPIO_PABC_ISR		(GPIO_CTRL_REG_BASE + 0x10)
#define RTL838X_GPIO_PAB_IMR		(GPIO_CTRL_REG_BASE + 0x14)
#define RTL838X_GPIO_PC_IMR		(GPIO_CTRL_REG_BASE + 0x18)

#define RTL838X_EXT_GPIO_DIR_0		(RTL83XX_SWITCH_BASE + 0xA08C)
#define RTL838X_EXT_GPIO_DIR_1		(RTL83XX_SWITCH_BASE + 0xA090)
#define RTL838X_EXT_GPIO_DATA_0		(RTL83XX_SWITCH_BASE + 0xA094)
#define RTL838X_EXT_GPIO_DATA_1		(RTL83XX_SWITCH_BASE + 0xA098)
#define RTL838X_EXT_GPIO_INDRT_ACCESS	(RTL83XX_SWITCH_BASE + 0xA09C)
#define RTL838X_EXTRA_GPIO_CTRL		(RTL83XX_SWITCH_BASE + 0xA0E0)
#define RTL838X_EXTRA_GPIO_DIR_0	(RTL83XX_SWITCH_BASE + 0xA0E4)
#define RTL838X_EXTRA_GPIO_DIR_1	(RTL83XX_SWITCH_BASE + 0xA0E8)
#define RTL838X_EXTRA_GPIO_DATA_0	(RTL83XX_SWITCH_BASE + 0xA0EC)
#define RTL838X_EXTRA_GPIO_DATA_1	(RTL83XX_SWITCH_BASE + 0xA0F0)
#define RTL838X_DMY_REG5		(RTL83XX_SWITCH_BASE + 0x144)
#define RTL838X_EXTRA_GPIO_CTRL		(RTL83XX_SWITCH_BASE + 0xA0E0)

#define RTL838X_IO_DRIVING_ABILITY_CTRL	(RTL83XX_SWITCH_BASE + 0x1010)

#define RTL838X_GPIO_A7		31
#define RTL838X_GPIO_A6		30
#define RTL838X_GPIO_A5		29
#define RTL838X_GPIO_A4		28
#define RTL838X_GPIO_A3		27
#define RTL838X_GPIO_A2		26
#define RTL838X_GPIO_A1		25
#define RTL838X_GPIO_A0		24
#define RTL838X_GPIO_B7		23
#define RTL838X_GPIO_B6		22
#define RTL838X_GPIO_B5		21
#define RTL838X_GPIO_B4		20
#define RTL838X_GPIO_B3		19
#define RTL838X_GPIO_B2		18
#define RTL838X_GPIO_B1		17
#define RTL838X_GPIO_B0		16
#define RTL838X_GPIO_C7		15
#define RTL838X_GPIO_C6		14
#define RTL838X_GPIO_C5		13
#define RTL838X_GPIO_C4		12
#define RTL838X_GPIO_C3		11
#define RTL838X_GPIO_C2		10
#define RTL838X_GPIO_C1		9
#define RTL838X_GPIO_C0		8

/*
 * Reset
 */
#define	RGCR				(RTL83XX_SWITCH_BASE + 0x1E70)
#define RTL839X_RST_GLB_CTRL		(RTL83XX_SWITCH_BASE + 0x14)
#define RTL838X_RST_GLB_CTRL_1		(RTL83XX_SWITCH_BASE + 0x40)

/* LED control by switch */
#define RTL838X_LED_MODE_SEL		(RTL83XX_SWITCH_BASE + 0x1004)
#define RTL838X_LED_MODE_CTRL		(RTL83XX_SWITCH_BASE + 0xA004)
#define RTL838X_LED_P_EN_CTRL		(RTL83XX_SWITCH_BASE + 0xA008)

/* LED control by software */
#define RTL838X_LED_SW_CTRL		(RTL83XX_SWITCH_BASE + 0xA00C)
#define RTL838X_LED0_SW_P_EN_CTRL	(RTL83XX_SWITCH_BASE + 0xA010)
#define RTL838X_LED1_SW_P_EN_CTRL	(RTL83XX_SWITCH_BASE + 0xA014)
#define RTL838X_LED2_SW_P_EN_CTRL	(RTL83XX_SWITCH_BASE + 0xA018)
#define RTL838X_LED_SW_P_CTRL(p)	(RTL83XX_SWITCH_BASE + 0xA01C + ((p) << 2))

/*
 * Switch interrupts
 */
#define RTL838X_IMR_GLB			(RTL83XX_SWITCH_BASE + 0x1100)
#define RTL838X_IMR_PORT_LINK_STS_CHG	(RTL83XX_SWITCH_BASE + 0x1104)
#define RTL838X_ISR_GLB_SRC		(RTL83XX_SWITCH_BASE + 0x1148)
#define RTL838X_ISR_PORT_LINK_STS_CHG	(RTL83XX_SWITCH_BASE + 0x114C)
#define RTL839X_IMR_GLB			(RTL83XX_SWITCH_BASE + 0x0064)
#define RTL839X_IMR_PORT_LINK_STS_CHG	(RTL83XX_SWITCH_BASE + 0x0068)
#define RTL839X_ISR_GLB_SRC		(RTL83XX_SWITCH_BASE + 0x009c)
#define RTL839X_ISR_PORT_LINK_STS_CHG	(RTL83XX_SWITCH_BASE + 0x00a0)


// TODO: not used
/*
 * MDIO via Realtek's SMI interface
 */
#define RTL838X_SMI_ACCESS_PHY_CTRL_3	(RTL83XX_SWITCH_BASE + 0xa1c4)
#define RTL838X_SMI_PORT0_5_ADDR_CTRL	(RTL83XX_SWITCH_BASE + 0xa1c8)


#endif   /* _MACH_RTL838X_H_ */
